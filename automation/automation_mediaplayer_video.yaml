###############################################################################################################
# AUTOMATION_MEDIAPLAYER_VIDEO:
###############################################################################################################
#
# Automations for chromecast, plex, apple tv, ...
#
###############################################################################################################
  - alias: Mediaplayer on TV paused or stopped

    trigger:
      - platform: state
        entity_id:
          - media_player.plex_apple_tv
          - media_player.chromecast
        from: 'playing'

    condition:
      - condition: state
        entity_id: sun.sun
        state: 'below_horizon'
      - condition: state
        entity_id: input_boolean.tv_onoff
        state: 'on'
      - condition: state
        entity_id: input_boolean.disable_all_automations
        state: 'off'
    action:
      - service: scene.turn_on
        entity_id: scene.dimmed
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.tv_onoff


###############################################################################################################
  - alias: Mediaplayer on TV playing

    trigger:
      - platform: state
        entity_id:
          - media_player.chromecast
          - media_player.plex_apple_tv
        to: 'playing'

    condition:
      - condition: state
        entity_id: input_boolean.disable_all_automations
        state: 'off'

    action:
      - service: media_player.turn_off
        data:
          entity_id:
            - media_player.soundtouch_living_room
            - media_player.google_home
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.tv_onoff
      - condition: state
        entity_id: sun.sun
        state: 'below_horizon'
      - service: scene.turn_on
        data_template:
          entity_id: >
            {% if is_state_attr('media_player.chromecast','media_title','Het journaal') %}
              scene.dinner
            {% else %}
              scene.watch_tv_blue
            {% endif %}
